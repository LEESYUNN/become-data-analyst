Wine Exploration Data Analysis
========================================================

I choose the white wine dataset to perform exploration data analysis. There are 12 variables in the original data. All about chemical compositions except one output variable: the quality scored by at least three wine specialists. I want to figure out the key compositions that affect the taste of white wine.

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
library(dplyr)
library(gridExtra)
library(GGally)
```
```{r echo=FALSE, Load_the_Data}
# Load the Data
wineData <- read.csv('wineQualityWhites.csv', na.strings = c('', 'NA'))

# create a new variable called sugar.acidity to represent the ratio between residual sugar and total acidity
wineData$sugar.acidity <- (wineData$fixed.acidity + wineData$volatile.acidity + wineData$citric.acid) / wineData$residual.sugar

# create a new variable called bound.sulfur.dioxide
wineData$bound.sulfur.dioxide <- wineData$total.sulfur.dioxide - wineData$free.sulfur.dioxide

# select and rearrange variables
wineData <- select(wineData, quality, fixed.acidity, volatile.acidity, citric.acid, residual.sugar, sugar.acidity, chlorides, free.sulfur.dioxide, bound.sulfur.dioxide, sulphates, density, pH, alcohol)
```

# Univariate Plots Section
```{r echo=FALSE, Univariate_Plots}
dim(wineData)
```
```{r echo=FALSE, Univariate_Plots}
summary(wineData)
```
There are 4898 observations, 13 variables to be explored, and the basic summaries are displayed above.

```{r echo=FALSE, Univariate_Plots}
# histogram of quality scores
ggplot(data=wineData, aes(x=quality)) + geom_bar()
```
The quality score is the variable most interested in. There are six kinds of quality scores in the dataset. Most of the white wine has a score of 6.

```{r echo=FALSE, Univariate_Plots}
# histogram of fixed acidity
ggplot(data=wineData, aes(x=fixed.acidity)) + geom_histogram()
```
Most of the white wine has a fixed acidity between 6 and 8 $g/dm^3$. About 1000 white wine has a fixed acidity of nearly 7 $g/dm^3$.

```{r echo=FALSE, Univariate_Plots}
# histogram of volatile acidity
ggplot(data=wineData, aes(x=volatile.acidity)) + geom_histogram()
```
Most of the white wine has a volatile acidity between 0.15 and 0.31 $g/dm^3$ approximately. The number of wine with volatile acdity about 0.27 $g/dm^3$ is nearly 1000.

```{r echo=FALSE, Univariate_Plots}
# histogram of citric acidity
ggplot(data=wineData, aes(x=citric.acid)) + geom_histogram()
```
Most of the white wine has a citric acidity between 0.25 and 0.4 $g/dm^3$. From all the three plots above we can see that the distribution of acidity in wine is somewhat normal.

```{r echo=FALSE, Univariate_Plots}
# histogram and boxplot of residual sugar
pSugarHist <- ggplot(data=wineData, aes(x=residual.sugar)) + geom_histogram(bins=100)
pSugarHistScaled <- ggplot(data=wineData, aes(x=residual.sugar)) + geom_histogram(bins=100) + scale_x_log10()
pSugarBox <- ggplot(data=wineData, aes(x='residual sugar', y=residual.sugar)) + geom_boxplot()
grid.arrange(pSugarHist, pSugarHistScaled, pSugarBox, ncol=3)
```
Because the histogram is highly left-skewed, I create a log-transformed version in middle. And we can see from the log-tranformed histogram that the residual sugar of most white wine is below 15 $g/dm^3$. But from the boxplot there are some outliers with high value above 60 $g/dm^3$, that's too sweet.

```{r echo=FALSE, Univariate_Plots}
# histogram of sugar-acidity ratio
ggplot(data=wineData, aes(x=sugar.acidity)) + geom_histogram(bins=60)
```
This shows the distribution of sugar/acidity ratio. Most of the white wine has a ratio between 0 and 2.5.

```{r echo=FALSE, Univariate_Plots}
# histogram of salt
ggplot(data=wineData, aes(x=chlorides)) + geom_histogram(bins=200)
```
Most of the white wine has chlorides between 0.01 and 0.05 $g/dm^3$, this is the amount of salt in wine. A too high value may lead the wine too salty.

```{r echo=FALSE, Univariate_Plots}
# histograms about free, bound sulfur dioxide and sulphates
pFreeSulfur <- ggplot(data=wineData, aes(x=free.sulfur.dioxide)) + geom_histogram()
pBoundSulfur <- ggplot(data=wineData, aes(x=bound.sulfur.dioxide)) + geom_histogram()
pSulphates <- ggplot(data=wineData, aes(x=sulphates)) + geom_histogram()
grid.arrange(pFreeSulfur, pBoundSulfur, pSulphates, ncol=3)
```
The chemical composition of sulfur dioxide can prevent microbial growth and oxidation of wine. But it is somewhat harmful so the amount has to be limited. Most of the wine has a free sulfur dioxide below 100 $mg/dm^3$, a bound one between 50 - 150 $mg/dm^3$. Sulphates is an wine additive that can keep sulfur dioxide levels, most wine has about 0.3 - 0.6 $mg/dm^3$

```{r echo=FALSE, Univariate_Plots}
# histogram of density
ggplot(data=wineData, aes(x=density)) + geom_histogram(bins=100)
```
Most wine has a density around 1.00 $g/cm^3$.

```{r echo=FALSE, Univariate_Plots}
# histogram of pH
ggplot(data=wineData, aes(x=pH)) + geom_histogram()
```
All the wine is naturally acidic. And most of them are in pH 3.0 - 3.3.

```{r echo=FALSE, Univariate_Plots}
# histograms of alcohol
ggplot(data=wineData, aes(x=alcohol)) + geom_histogram(bins=60)
```
White wine is a kind of low-alcohol drink. Most of them has alcohol range from 9% to 12% by volume.

# Univariate Analysis

### What is the structure of your dataset?
```{r echo=FALSE, Univariate_Plots}
str(prosperDataSet)
```
My dataset contains 13 variables. "ProsperRating..Alpha." is an ordered factor indicating borrower's rating: 
worst -----------------------> best
HR -> E -> D -> C -> B -> A -> AA

### What is/are the main feature(s) of interest in your dataset?
"YieldPercentage" is the main feature of interest in my dataset, it is defined as "YieldPercentage = LenderYield * LP_CustomerPrincipalPayments / LoanOriginalAmount". An investor is likely to benefit from the loan if the corresponding yield percentage is high. I want to figure out how other features affect it. Especially how do investors assess different features when planning to invest some loans?

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
I think average credit score, DTI ratio, prosper ratings and listing categories likely contribute to the yield percentage of loan, and maybe the occupation, employment status and duration are important factors to consider. 

### Did you create any new variables from existing variables in the dataset?
Yes, I create a new variable called "YieldPercentage" as a somewhat quantified indicator of the investor's yield, and since the original data gives credit score as a range, I simply take the average value of upper and lower bound to make a new variable called "CreditScoreAverage", this may simplifies the following analysis.

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?
Yes, the distribution of debt to income ratio is highly left-skewed, thus hard to analyze. So I perform a log scale transform on x axis, makes it more easier to figure out whar are the most common DTI ratios among all the borrowers.


# Bivariate Plots Section
```{r echo=FALSE, warning=FALSE, Bivariate_Plots}
prosperSub <- select(prosperDataSet, YieldPercentage, CreditScoreAverage, PublicRecordsLast10Years, InquiriesLast6Months, TradesNeverDelinquent..percentage., DebtToIncomeRatio, EmploymentStatusDuration)

set.seed(8341)
ggpairs(prosperSub[sample.int(nrow(prosperSub), 5000), ])
```
Based on the scatter plot matrix, there are no strong correlations existed.
```{r echo=FALSE, Bivariate_Plots}
```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

### What was the strongest relationship you found?




# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection
